FROM python:3.10-slim

WORKDIR /app

# Copy requirements and install dependencies
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# Copy monitoring code
COPY services/monitoring/ .
COPY data/ ./data/
COPY models/ ./models/

# Set environment variables
ENV MLFLOW_TRACKING_URI=http://mlflow:5000
ENV POSTGRES_HOST=postgres
ENV POSTGRES_DB=churn_ml_monitoring
ENV POSTGRES_USER=postgres
ENV POSTGRES_PASSWORD=postgres

CMD ["python", "monitor_churn_model.py"]
